<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="VOdSVFLZgu5oX1fWGwT5OkE9QF-b6k3XMEZIkFIuiTA" />

<title>Go言語の忘れがちなtime fomatの話 - ◯ △ □</title>

<link rel="icon" href="https://blog.yudppp.com/img/favicon.png">
<link rel="shortcut icon" href="https://blog.yudppp.com/img/favicon.png">
<link rel="stylesheet" href="https://blog.yudppp.com/css/lib.min.css">
<link rel="stylesheet" href="https://blog.yudppp.com/css/app.min.css">
<link rel="alternate" href="https://blog.yudppp.com/index.xml" title="" type="application/rss+xml">

<meta property="og:type", content="article">
<meta property="og:url", content="https://blog.yudppp.com/posts/golang_time_format/">
<meta property="og:site_name", content="◯ △ □">
<meta property="og:title", content="Go言語の忘れがちなtime fomatの話">


  <meta name="description" content="この記事はGo Advent Calendar 2016 - Qiitaの7日目の記事です。 apexの話でもしようと思ったのですが時間がなく別の記事を書くことにしました。
Golangを仕事で書き始めて、もう丸2年になりますが、未だに必要になると毎回ググって調べてから利用するものがあります。 その一つがtimeパッケージのフォーマットです。 GolangではいわゆるYYYYMMDDのような形式ではなく20060102といった特定の日時をベースにした文字列で表す必要があります。
123の順で振られていること、2006年なこと等なんとなくは覚えてきているのですが、確認をしないと不安で仕方なくなります。
この2年間で最低でも10回以上はgolang time formatでググり、その度にmattnさんの記事に辿り着いていました。 同じ記事を何度も見るのは自分に負けた気になるので悲しいです。
Golangの本家の実装を見るとわかるのですがtime/format.goの130行目あたりのnextStdChunkという関数でパースをしています。
これを基に判別表を作成しました。
   format about     January Month(long)   Jan Month(short)   1 Month Number   01 Month Number(zero埋め)   Monday WeekDay(long)   Mon WeekDay(short)   2 Day   _2 Day(space埋め)   02 Day(zero埋め)   15 Hour(24h)   3 Hour(12h)   03 Hour(12h,zero埋め)   4 Minute   04 Minute(zero埋め)   5 Second   05 Second(zero埋め)   2006 Year(long)   06 Year(short)   PM AM or PM   pm am or pm   MST TimeZone   Z0700 ISO8601TZ   Z070000 ISO8601TZ(seconds)   Z07 ISO8601TZ(short)   Z07:00 ISO8601TZ(colon)   Z07:00:00 ISO8601TZ(seconds/colon)   -0700 NumTimeZone   -070000 NumTimeZone(seconds)   -07 NumTimeZone(short)   -07:00 NumTimeZone(colon)   -07:00:00 NumTimeZone(seconds/colon)   .">


  </head>
  <body class="hack">
    <header>
  <div class="container">
    
    <div class="nav">
      <div class="nav__left">
        <span class="nav__item">
          <a class="nocolor" href="https://blog.yudppp.com">
            <canvas class="mini-logo" width="150" height="50">
          </a>
        </span>
      </div>
    </div>
    <div class="title">
      <h1>Go言語の忘れがちなtime fomatの話</h1>
    </div>
    
  </div>
</header>

    <main>
      <div class="container">
        <date>2016.12.06</date>
        <div class="content">
          <p>この記事は<a href="http://qiita.com/advent-calendar/2016/go">Go Advent Calendar 2016 - Qiita</a>の7日目の記事です。
<a href="https://github.com/apex/apex">apex</a>の話でもしようと思ったのですが時間がなく別の記事を書くことにしました。</p>

<p>Golangを仕事で書き始めて、もう丸2年になりますが、未だに必要になると毎回ググって調べてから利用するものがあります。
その一つが<code>time</code>パッケージのフォーマットです。
Golangではいわゆる<code>YYYYMMDD</code>のような形式ではなく<code>20060102</code>といった特定の日時をベースにした文字列で表す必要があります。</p>

<p>123の順で振られていること、2006年なこと等なんとなくは覚えてきているのですが、確認をしないと不安で仕方なくなります。</p>

<p>この2年間で最低でも10回以上は<code>golang time format</code>でググり、その度にmattnさんの<a href="http://mattn.kaoriya.net/software/lang/go/20130620173712.html">記事</a>に辿り着いていました。
同じ記事を何度も見るのは自分に負けた気になるので悲しいです。</p>

<p>Golangの本家の実装を見るとわかるのですが<a href="https://golang.org/src/time/format.go">time/format.go</a>の130行目あたりの<code>nextStdChunk</code>という関数でパースをしています。</p>

<p>これを基に判別表を作成しました。</p>

<table>
<thead>
<tr>
<th align="left">format</th>
<th align="left">about</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">January</td>
<td align="left">Month(long)</td>
</tr>

<tr>
<td align="left">Jan</td>
<td align="left">Month(short)</td>
</tr>

<tr>
<td align="left">1</td>
<td align="left">Month Number</td>
</tr>

<tr>
<td align="left">01</td>
<td align="left">Month Number(zero埋め)</td>
</tr>

<tr>
<td align="left">Monday</td>
<td align="left">WeekDay(long)</td>
</tr>

<tr>
<td align="left">Mon</td>
<td align="left">WeekDay(short)</td>
</tr>

<tr>
<td align="left">2</td>
<td align="left">Day</td>
</tr>

<tr>
<td align="left">_2</td>
<td align="left">Day(space埋め)</td>
</tr>

<tr>
<td align="left">02</td>
<td align="left">Day(zero埋め)</td>
</tr>

<tr>
<td align="left">15</td>
<td align="left">Hour(24h)</td>
</tr>

<tr>
<td align="left">3</td>
<td align="left">Hour(12h)</td>
</tr>

<tr>
<td align="left">03</td>
<td align="left">Hour(12h,zero埋め)</td>
</tr>

<tr>
<td align="left">4</td>
<td align="left">Minute</td>
</tr>

<tr>
<td align="left">04</td>
<td align="left">Minute(zero埋め)</td>
</tr>

<tr>
<td align="left">5</td>
<td align="left">Second</td>
</tr>

<tr>
<td align="left">05</td>
<td align="left">Second(zero埋め)</td>
</tr>

<tr>
<td align="left">2006</td>
<td align="left">Year(long)</td>
</tr>

<tr>
<td align="left">06</td>
<td align="left">Year(short)</td>
</tr>

<tr>
<td align="left">PM</td>
<td align="left">AM or PM</td>
</tr>

<tr>
<td align="left">pm</td>
<td align="left">am or pm</td>
</tr>

<tr>
<td align="left">MST</td>
<td align="left">TimeZone</td>
</tr>

<tr>
<td align="left">Z0700</td>
<td align="left">ISO8601TZ</td>
</tr>

<tr>
<td align="left">Z070000</td>
<td align="left">ISO8601TZ(seconds)</td>
</tr>

<tr>
<td align="left">Z07</td>
<td align="left">ISO8601TZ(short)</td>
</tr>

<tr>
<td align="left">Z07:00</td>
<td align="left">ISO8601TZ(colon)</td>
</tr>

<tr>
<td align="left">Z07:00:00</td>
<td align="left">ISO8601TZ(seconds/colon)</td>
</tr>

<tr>
<td align="left">-0700</td>
<td align="left">NumTimeZone</td>
</tr>

<tr>
<td align="left">-070000</td>
<td align="left">NumTimeZone(seconds)</td>
</tr>

<tr>
<td align="left">-07</td>
<td align="left">NumTimeZone(short)</td>
</tr>

<tr>
<td align="left">-07:00</td>
<td align="left">NumTimeZone(colon)</td>
</tr>

<tr>
<td align="left">-07:00:00</td>
<td align="left">NumTimeZone(seconds/colon)</td>
</tr>

<tr>
<td align="left">.0, .00, .000, &hellip;</td>
<td align="left">FracSecond(trailing zeros included)</td>
</tr>

<tr>
<td align="left">.9, .99, .999, &hellip;</td>
<td align="left">FracSecond(trailing zeros omitted)</td>
</tr>
</tbody>
</table>

<p>またさっとYYYYMMDDで書いた時ものを置換したりしたいので、その場合のための簡単な<a href="https://github.com/yudppp/gotimefmt">ツール</a>を作成しました。</p>

<pre><code class="language-sh">$ go get github.com/yudppp/gotimefmt/cmd/gotimefmt
$ gotimefmt YYYYMMDD
------------------------------------
format: 20060102
now:    20161206
------------------------------------
</code></pre>

<p>のようにさっとFormatと現在時間を出力されるようにしました。</p>

<p>timeのformatに悩まされずに済むようになりたいです。</p>

          <a href="https://twitter.com/share" class="twitter-share-button" data-via="yudppp">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="standard-noballoon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
          <div class="comment">
    <div>
        <a id="js-open-comment" class="event">
            show comment <span class="disqus-comment-count" data-disqus-url="https://blog.yudppp.com/posts/golang_time_format/"></span>
        </a>
    </div>
    <div id="disqus_thread"></div>
</div>
<script type="text/javascript">
     
     
    var openDiqus = function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//yudppp.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    document.all("js-open-comment").style.display = "none";
    };
    document.getElementById("js-open-comment").addEventListener('click',openDiqus,false);
</script>
        </div>
      </div>
    </main>
    
<div class="container">
	<div class="prevnext">
		
		<a class="pull-left" href="https://blog.yudppp.com/posts/json2struct/">
			<div>&lt;&lt; JSONをGolangのstructに変換する</div>
		</a>
		
		
		<a class="pull-right" href="https://blog.yudppp.com/posts/csv_fast_upload/">
			<div>Golangで大きなcsvのインポートを速くする &gt;&gt;</div>
		</a>
		
	</div>
</div>

    <div class="container">
  <a href="https://blog.yudppp.com/posts/whoami/">
    <div class="media profile">
      <div class="media-left">
        <img class="avatarholder" src="https://blog.yudppp.com/img/profile.svg" />
      </div>
      <div class="media-body">
        <div class="media-heading">@yudppp</div>
        <div class="media-content">Web engineer.</div>
      </div>
    </div>
  </a>
</div>

    <script src="https://blog.yudppp.com/js/lib.min.js"></script>
<script src="https://blog.yudppp.com/js/app.min.js"></script>
<script id="dsq-count-scr" src="//yudppp.disqus.com/count.js" async></script>
  </body>
</html>
